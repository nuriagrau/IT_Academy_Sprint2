db.createCollection('orders', {validator: {$jsonSchema: {bsonType: 'object',title: 'orders',required: ['shop','delivery','client','isPaid','isDelivered'],properties:{orderDate:{bsonType: 'date'},shop:{bsonType: 'object',title: 'object',required: ['name'],properties:{id:{bsonType: 'objectId'},name:{bsonType: 'string'},adress:{bsonType: 'object',title: 'object',required: ['street','city/town','postCode'],properties:{street:{bsonType: 'string'},number:{bsonType: 'string'},city/town:{bsonType: 'string'},county:{bsonType: 'string'},postCode:{bsonType: 'string'}}}}},orderLines:{bsonType: 'array',items:{title: 'object',required: ['quantity','product','linePrice'],properties:{quantity:{bsonType: 'int'},product:{bsonType: 'object',title: 'object',required: ['id','name','description','type','unitPrice'],properties:{id:{bsonType: 'objectId'},name:{bsonType: 'string'},description:{bsonType: 'string'},type:{enum: ["pizza", "burger", "beverage"]},pizzaCategory:{bsonType: 'string'},unitPrice:{bsonType: 'decimal'},image:{bsonType: 'binData'}}},linePrice:{bsonType: 'int',{§multiply: [quantity], [unitPrice]}}}},description: '{§multiply: [quantity], [unitPrice]}'},totalPrice:{bsonType: 'int',description: '{§add: §[linePrice]}'},delivery:{bsonType: 'object',title: 'object',properties:{shop:{bsonType: 'bool'},home:{bsonType: 'object',title: 'object',properties:{deliveryIn:{bsonType: 'object',title: 'object',required: ['street','number','contactNumber'],properties:{street:{bsonType: 'string'},number:{bsonType: 'string'},floor:{bsonType: 'string'},contactNumber:{bsonType: 'string'},note:{bsonType: 'string'}}},deliverer:{bsonType: 'object',title: 'object',required: ['firstName','lastName','NIF','telephone','idShop'],properties:{firstName:{bsonType: 'string'},lastName:{bsonType: 'string'},NIF:{bsonType: 'string'},telephone:{bsonType: 'string'},idShop:{bsonType: 'objectId'}}},deliveredOn:{bsonType: 'date'}},description: 'if ´delivery`.`shop`= false'}}},client:{bsonType: 'object',title: 'object',required: ['id','firstName','address'],properties:{id:{bsonType: 'objectId'},firstName:{bsonType: 'string'},lastName:{bsonType: 'string'},address:{bsonType: 'object',title: 'object',required: ['street','number','floor','city/town','county','postCode','telephone'],properties:{street:{bsonType: 'string'},number:{bsonType: 'string'},floor:{bsonType: 'string'},city/town:{bsonType: 'string'},county:{bsonType: 'string'},postCode:{bsonType: 'string'},telephone:{bsonType: 'string'}}}}},isPaid:{bsonType: 'bool'},isDelivered:{bsonType: 'bool'},notes:{bsonType: 'string'}}}}});